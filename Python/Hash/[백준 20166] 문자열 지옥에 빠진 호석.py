'''
[ë°±ì¤€ 20166] ë¬¸ìì—´ ì§€ì˜¥ì— ë¹ ì§„ í˜¸ì„
https://www.acmicpc.net/problem/20166

[ğŸ“Œ ì „ëµ]
- ë‹¨ìˆœ bfsë¡œ í’€ì´í•  ì‹œ ì‹œê°„ ì´ˆê³¼ ë°œìƒ
- ì‹œê°„ ë‹¨ì¶• ìœ„í•œ ë”•ì…”ë„ˆë¦¬ ì‚¬ìš©

[âœ… í’€ì´]
1. ê° ë¬¸ìë“¤ì„ ëŒë©° bfs ì‹¤ì‹œ -> ê°€ëŠ¥í•œ ë¬¸ìì—´ë“¤ì„ ì°¾ì•„ ë”•ì…”ë„ˆë¦¬ì— ë¬¸ìì—´: ê°œìˆ˜ í˜•ì‹ìœ¼ë¡œ ì €ì¥
    í ìš”ì†Œë¥¼ popleft
    ì•„ì§ ë”•ì…”ë„ˆë¦¬ì— ì—†ë‹¤ë©´, ë”•ì…”ë„ˆë¦¬ì— ì¶”ê°€í•˜ê³  1
    ìˆë‹¤ë©´ +1í•˜ì—¬ ê°±ì‹ 

    ì‹ ì´ ì¢‹ì•„í•˜ëŠ” ë¬¸ìì—´ ìµœëŒ€ ê°œìˆ˜(5)ë³´ë‹¤ ì‘ì„ ì‹œ ìƒí•˜ì¢Œìš°, ëŒ€ê°ì„  ë°©í–¥ì„ ì „ë¶€ ìˆœíšŒí•˜ë©° ê°€ëŠ¥í•œ ë¬¸ìì—´ë“¤ì„ ì°¾ìŒ
    ì´ë•Œ ë¬¸ì œì˜ ì¡°ê±´ì— ë§ëŠ” ì¸ë±ìŠ¤ ë³´ì • í•„ìš”

2. ì…ë ¥ë°›ì€ ì‹ ì´ ì¢‹ì•„í•˜ëŠ” ë¬¸ìì—´ì„ í‚¤ë¡œí•˜ì—¬ ê·¸ ê°’ì„ ì¶œë ¥
    ë”•ì…”ë„ˆë¦¬ì— ì¡´ì¬í•˜ì§€ ì•Šì„ ë•ŒëŠ” 0ì„ ì¶œë ¥

[ğŸ“ ê¸°ë¡]
LV: ê³¨ë“œ4
í’€ì´ ì‹œê°„: 50ë¶„
'''

import sys
from collections import deque

input = sys.stdin.readline

n, m, k = map(int, input().split())
board = []
words = []

for _ in range(n): board.append(input().strip())

for _ in range(k): words.append(input().strip())

# ìƒí•˜ì¢Œìš° + ëŒ€ê°ì„ 
dirs = [(-1, 0), (1, 0), (0, 1), (0, -1), (1, -1), (1, 1), (-1, 1), (-1, -1)]
dict = dict() # ê°€ëŠ¥í•œ ë¬¸ìì—´ë“¤ì„ ì €ì¥í•  ë”•ì…”ë„ˆë¦¬

def bfs(i, j):
    q = deque([[i, j, board[i][j]]])

    while q:
        x, y, w = q.popleft()

        # ë”•ì…”ë„ˆë¦¬ì— ì—†ìœ¼ë©´ ì¶”ê°€
        if w not in dict:
            dict[w] = 1
        else: # ìˆë‹¤ë©´ ê°±ì‹ 
            dict[w] += 1

        # ì‹ ì´ ì¢‹ì•„í•˜ëŠ” ë¬¸ìì—´ì˜ ìµœëŒ€ ê°œìˆ˜ë¥¼ ë„˜ìœ¼ë©´
        if len(w) >= 5: continue

        for dir in dirs:
            nx, ny = x+dir[0], y+dir[1]

            # ì¸ë±ìŠ¤ ë³´ì •
            if nx < 0: nx = n-1 # -1ì¼ ê²½ìš°, n-1
            if nx >= n: nx = 0 # nì¼ ê²½ìš°, 0
            if ny < 0: ny = m-1 # -1ì¼ ê²½ìš°, m-1
            if ny >= m: ny = 0 # mì¼ ê²½ìš° 0

            # ê¸°ì¡´ ë¬¸ìì—´ wì— board[nx][ny]ë¥¼ ì¶”ê°€í•˜ì—¬ íì— ë„£ìŒ
            q.append([nx, ny, w + board[nx][ny]])

for i in range(n):
    for j in range(m):
        bfs(i, j)

for word in words:
    if word in dict:
        print(dict[word])
    else:
        print(0)