//
//  [ë°±ì¤€ 14499] ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°.swift
//  Algorithm
//
//  Created by ê¹€ë¯¼ on 3/10/24.
//
// ë°±ì¤€ 14499 ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸° https://www.acmicpc.net/problem/14499

/*
[ğŸ“Œ ì „ëµ]
 ì£¼ì‚¬ìœ„ë¥¼ ì´ë™ì‹œí‚¤ëŠ” ê²ƒë§Œ ì˜ ê³ ë ¤í•´ì„œ ë¡œì§ì„ ì§œì£¼ë©´ ëœë‹¤.

[âœ… í’€ì´]
 ì£¼ì‚¬ìœ„ì˜ ê° ìœ„ì¹˜ë¥¼ 1ì°¨ì› ë°°ì—´ë¡œ ë‚˜íƒ€ëƒ„ 1ì´ ìœ—ë©´, 3ì´ ê°€ì¥ ì•„ë«ë©´, 5ê°€ ë™ìª½
    [1]
 [5][2][6]
    [3]
    [4]
 1. ë¶ìª½ìœ¼ë¡œ ì´ë™í•  ë•ŒëŠ” ìœ„ìª½ìœ¼ë¡œ ì£¼ì‚¬ìœ„ë¥¼ í•œì¹¸ êµ´ë¦¬ê¸°
    ì£¼ì‚¬ìœ„ ë°°ì—´ë¡œ ë‚˜íƒ€ë‚´ë©´ [1, 2, 3, 4, 5, 6] -> [2, 3, 4, 1, 5, 6]
    ë§¨ì• 1ë²ˆ ìš”ì†Œë¥¼ ì œê±°í•œ ë’¤ 3ë²ˆì§¸ ì¸ë±ìŠ¤ ìë¦¬ì— ë„£ì–´ì£¼ê¸°
 2. ë‚¨ìª½ìœ¼ë¡œ ì´ë™í•  ë•ŒëŠ” ì•„ë˜ìª½ìœ¼ë¡œ ì£¼ì‚¬ìœ„ë¥¼ í•œì¹¸ êµ´ë¦¬ê¸°
    ì£¼ì‚¬ìœ„ ë°°ì—´ë¡œ ë‚˜íƒ€ë‚´ë©´ [1, 2, 3, 4, 5, 6] -> [4, 1, 2, 3, 5, 6]
    3ë²ˆì§¸ ì¸ë±ìŠ¤ë¥¼ ì œê±°í•œ ë’¤ ë§¨ ì•ì— ì‚½ì…í•˜ê¸°
 3. ë™ìª½ìœ¼ë¡œ ì´ë™í•  ë•ŒëŠ” ì˜¤ë¥¸ìª½ìœ¼ë¡œ í•œì¹¸ êµ´ë¦¬ê¸°
    ì£¼ì‚¬ìœ„ ë°°ì—´ë¡œ ë‚˜íƒ€ë‚´ë©´ [1, 2, 3, 4, 5, 6] -> [1, 5, 3, 6, 4, 2]
    5ë²ˆì§¸ ì¸ë±ìŠ¤ê°€ 3ë²ˆì§¸ ì¸ë±ìŠ¤ë¡œ, 3ë²ˆì§¸ ì¸ë±ìŠ¤ê°€ 4ë²ˆì§¸ ì¸ë±ìŠ¤ë¡œ
    1ë²ˆì§¸ ì¸ë±ìŠ¤ê°€ 5ë²ˆì§¸ ì¸ë±ìŠ¤ë¡œ, 4ë²ˆì§¸ ì¸ë±ìŠ¤ê°€ 1ë²ˆì§¸ ì¸ë±ìŠ¤ë¡œ
    ê°’ì´ ì´ë™í•´ì•¼ í•¨.
    ì´ë™í•˜ê¸° ì „ì— ê° ê°’ë“¤ì„ ëª¨ë‘ ì €ì¥í•˜ì—¬ ì•Œë§ì€ ì¸ë±ìŠ¤ì— ê°’ì„ ë„£ê¸°
 4. ì„œìª½ìœ¼ë¡œ ì´ë™í•  ë•ŒëŠ” ì™¼ìª½ìœ¼ë¡œ í•œì¹¸ êµ´ë¦¬ê¸°
    ì£¼ì‚¬ìœ„ ë°°ì—´ë¡œ ë‚˜íƒ€ë‚´ë©´ [1, 2, 3, 4, 5, 6] -> [1, 6, 3, 5, 2, 4]
    4ë²ˆì§¸ ì¸ë±ìŠ¤ê°€ 3ë²ˆì§¸ ì¸ë±ìŠ¤ë¡œ, 3ë²ˆì§¸ ì¸ë±ìŠ¤ê°€ 5ë²ˆì§¸ ì¸ë±ìŠ¤ë¡œ
    5ë²ˆì§¸ ì¸ë±ìŠ¤ê°€ 1ë²ˆì§¸ ì¸ë±ìŠ¤ë¡œ, 1ë²ˆì§¸ ì¸ë±ìŠ¤ê°€ 4ë²ˆì§¸ ì¸ë±ìŠ¤ë¡œ
    ê°’ì´ ì´ë™í•´ì•¼ í•¨.
    ì´ë™í•˜ê¸° ì „ì— ê° ê°’ë“¤ì„ ëª¨ë‘ ì €ì¥í•˜ì—¬ ì•Œë§ì€ ì¸ë±ìŠ¤ì— ê°’ì„ ë„£ê¸°

    ê° ëª…ë ¹ì— ë”°ëì„ ë•Œ ë²”ìœ„ ë‚´ì— ìˆëŠ”ì§€ ì²´í¬í•˜ê³ , ì´ë™ì„ í•œ ë’¤ ì£¼ì‚¬ìœ„ì™€ ì§€ë„ì˜ ê°’ì„ ë°”ê¾¼ í›„ì—ëŠ” ì£¼ì‚¬ìœ„ì˜ ìœ—ë©´ì¸ dice[1]ì„ ì¶œë ¥
*/


let line = readLine()!.split(separator: " ").map { Int($0)! }
var (n, m, x, y, k) = (line[0], line[1], line[2], line[3], line[4])
var board = Array(repeating: Array(repeating: 0, count: m), count: n)

for i in 0..<n {
    board[i] = readLine()!.split(separator: " ").map { Int($0)! }
}

let orders = readLine()!.split(separator: " ").map { Int($0)! }
var dice = Array(repeating: 0, count: 6)

func changeValue() {
    if board[x][y] == 0 {
        board[x][y] = dice[3]
    } else {
        dice[3] = board[x][y]
        board[x][y] = 0
    }

    print(dice[1])
}

func moveEast() {
    if y+1 >= m { return }
    y += 1

    let (w, s, e, m) = (dice[4], dice[3], dice[5], dice[1])
    dice[4] = s
    dice[3] = e
    dice[5] = m
    dice[1] = w

    changeValue()
}

func moveWest() {
    if y-1 < 0 { return }
    y -= 1

    let (w, s, e, m) = (dice[4], dice[3], dice[5], dice[1])
    dice[3] = w
    dice[5] = s
    dice[4] = m
    dice[1] = e

    changeValue()
}

func moveNorth() {
    if x-1 < 0 { return }
    x -= 1

    let tmp = dice.removeFirst()
    dice.insert(tmp, at: 3)

    changeValue()
}

func moveSouth() {
    if x+1 >= n { return }
    x += 1

    let tmp = dice.remove(at: 3)
    dice.insert(tmp, at: 0)

    changeValue()
}

orders.forEach { order in
    switch order {
    case 1:
        moveEast()
    case 2:
        moveWest()
    case 3:
        moveNorth()
    default:
        moveSouth()
    }
}
