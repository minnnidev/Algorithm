//
//  [ë°±ì¤€ 14891] í†±ë‹ˆë°”í€´.swift
//  Algorithm
//
//  Created by ê¹€ë¯¼ on 3/3/24.
//
// ë°±ì¤€ 14891 í†±ë‹ˆë°”í€´ https://www.acmicpc.net/problem/14891

/*
[ğŸ“Œ ì „ëµ]
 1. íšŒì „ì„ ì‹œì‘í•˜ëŠ” í†±ë‹ˆë°”í€´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê·¹ì´ ë‹¤ë¥¼ ê²½ìš°ì—ë§Œ íšŒì „ì´ ì´ì–´ì§ˆ ìˆ˜ ìˆë‹¤. ì´ë•Œ íšŒì „ ë°©í–¥ì€ ë°˜ëŒ€ì´ë‹¤.
 2. ê·¹ì´ ê°™ì„ ê²½ìš°ì—ëŠ” ê·¸ ì´í›„ë¡œ ì´ì–´ì§€ëŠ” í†±ë‹ˆë°”í€´ëŠ” íšŒì „í•  ìˆ˜ ì—†ë‹¤.
 3. ëª¨ë“  í†±ë‹ˆë°”í€´ì˜ íšŒì „ ì—¬ë¶€ëŠ” í†±ë‹ˆë°”í€´ë¥¼ íšŒì „ì‹œí‚¨ ì´í›„ê°€ ì•„ë‹Œ íšŒì „ì„ ì‹œì‘í•˜ê¸° ì „ ì´ˆê¸° ìƒíƒœì—ì„œ ê²°ì •í•œë‹¤.
 4. ì‹œê³„ ë°©í–¥ & ë°˜ì‹œê³„ ë°©í–¥ íšŒì „ì˜ ì•Œë§ì€ ì¸ë±ìŠ¤ ì²˜ë¦¬
 4ê°€ì§€ í¬ì¸íŠ¸ë¥¼ ê³ ë ¤í•˜ì—¬ ë¬¸ì œë¥¼ í’€ì´í•œë‹¤.

[âœ… í’€ì´]
 ì‹œì‘í•˜ëŠ” í†±ë‹ˆë°”í€´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì™¼ìª½ ë°©í–¥, ì˜¤ë¥¸ìª½ ë°©í–¥ìœ¼ë¡œ ë‚˜ëˆ  íšŒì „ ì—¬ë¶€ë¥¼ ê²°ì •í•œë‹¤.
 while ë¬¸ìœ¼ë¡œ ë²”ìœ„ ë‚´ì¸ì§€ ì²´í¬í•˜ë©°
 - ì™¼ìª½ ë°©í–¥ìœ¼ë¡œ ì´ì–´ì§€ëŠ” í†±ë‹ˆë°”í€´ì˜ íšŒì „ ì—¬ë¶€ë¥¼ íŒë‹¨í•  ë•ŒëŠ”, í˜„ì¬ index í†±ë‹ˆë°”í€´ì˜ 9ì‹œ ë°©í–¥(ì…ë ¥ë°›ì€ í†±ë‹ˆë°”í€´ì˜ 6ë²ˆì§¸ ì¸ë±ìŠ¤),
   ì™¼ìª½ í†±ë‹ˆë°”í€´ì˜(index-1) 3ì‹œ ë°©í–¥(2ë²ˆì§¸ ì¸ë±ìŠ¤)ë¥¼ ë¹„êµí•˜ì—¬ ê·¹ì´ ë‹¤ë¥¸ì§€ ì²´í¬í•˜ê³ , ê·¹ì´ ë‹¤ë¥´ë‹¤ë©´ ë‹¤ìŒ ì™¼ìª½ í†±ë‹ˆë°”í€´ë„ íšŒì „ ê°€ëŠ¥ ì—¬ë¶€ë¥¼ íŒë‹¨í•œë‹¤.
 - ì˜¤ë¥¸ìª½ ë°©í–¥ìœ¼ë¡œ ì´ì–´ì§€ëŠ” í†±ë‹ˆë°”í€´ì˜ íšŒì „ ì—¬ë¶€ë¥¼ íŒë‹¨í•  ë•ŒëŠ”,
   í˜„ì¬ index í†±ë‹ˆë°”í€´ì˜ 3ì‹œ ë°©í–¥(2ë²ˆì§¸ ì¸ë±ìŠ¤)ì™€ ì˜¤ë¥¸ìª½ í†±ë‹ˆë°”í€´ì˜ 9ì‹œ ë°©í–¥(6ë²ˆì§¸ ì¸ë±ìŠ¤)ë¥¼ ë¹„êµí•˜ì—¬ ê·¹ì´ ë‹¤ë¥¸ì§€ ì²´í¬í•˜ê³  ë°˜ë³µí•œë‹¤.

 ìµœì¢…ì ìœ¼ë¡œ ê²°ì •ëœ 4ê°œì˜ í†±ë‹ˆë°”í€´ë¥¼ì˜ íšŒì „ ì—¬ë¶€ë¥¼ í•˜ë‚˜ì”© ìˆœíšŒí•˜ë©° ì‹œê³„, ë°˜ì‹œê³„ ë°©í–¥ì— ë”°ë¼ íšŒì „ì‹œí‚¨ë‹¤.
 ì‹œê³„ ë°©í–¥ íšŒì „ì€ ë°°ì—´ì—ì„œ ë§ˆì§€ë§‰ ì¸ë±ìŠ¤ë¥¼ ë°°ì—´ì˜ ì²« ë²ˆì§¸ ì¸ë±ìŠ¤ë¡œ ë„£ì–´ì£¼ë©° êµ¬í˜„í•  ìˆ˜ ìˆê³ ,
 ë°˜ì‹œê³„ ë°©í–¥ íšŒì „ì€ ë°°ì—´ì—ì„œ ì²« ë²ˆì§¸ ì¸ë±ìŠ¤ë¥¼ ì œê±°í•˜ì—¬ ë°°ì—´ì˜ ë§ˆì§€ë§‰ì— ë„£ì–´ì£¼ë©° êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.
*/

var gear1 = readLine()!.map { Int(String($0))! }
var gear2 = readLine()!.map { Int(String($0))! }
var gear3 = readLine()!.map { Int(String($0))! }
var gear4 = readLine()!.map { Int(String($0))! }
let k = Int(readLine()!)!
var gears = [gear1, gear2, gear3, gear4]

// ì‹œê³„ ë°©í–¥ íšŒì „
func spinCW(_ gear: [Int]) -> [Int] {
    var g = gear
    let last = g.popLast()!
    g.insert(last, at: 0)
    return g
}

// ë°˜ì‹œê³„ ë°©í–¥ íšŒì „
func spinCCW(_ gear: [Int]) -> [Int] {
    var g = gear
    let first = g.removeFirst()
    g.append(first)
    return g
}

func spinGear(_ startGear: Int, _ startDir: Int) {
    var dirs = [0, 0, 0, 0]
    dirs[startGear] = startDir

    // ì‹œì‘í•˜ëŠ” í†±ë‹ˆë°”í€´ ê¸°ì¤€ ì™¼ìª½ í†±ë‹ˆë°”í€´ë“¤ì„ íšŒì „ì‹œí‚¬ì§€ íŒë‹¨í•˜ê¸°
    var idx = startGear
    while idx > 0 && gears[idx][6] != gears[idx-1][2] {
        dirs[idx-1] = -dirs[idx]
        idx -= 1
    }

    // ì‹œì‘í•˜ëŠ” í†±ë‹ˆë°”í€´ ê¸°ì¤€ ì˜¤ë¥¸ìª½ í†±ë‹ˆë°”í€´ë“¤ì„ íšŒì „ì‹œí‚¬ì§€ íŒë‹¨í•˜ê¸°
    idx = startGear
    while idx < 3 && gears[idx][2] != gears[idx+1][6] {
        dirs[idx+1] = -dirs[idx]
        idx += 1
    }

    for i in 0..<4 {
        if dirs[i] == -1 { gears[i] = spinCCW(gears[i]) }
        else if dirs[i] == 1 { gears[i] = spinCW(gears[i]) }
    }
}

for _ in 0..<k {
    let line = readLine()!.split(separator: " ").map { Int($0)! }
    let (num, dir) = (line[0], line[1])

    spinGear(num-1, dir)
}

var sum = 0
if gears[0][0] == 1 { sum += 1 }
if gears[1][0] == 1 { sum += 2 }
if gears[2][0] == 1 { sum += 4 }
if gears[3][0] == 1 { sum += 8 }
print(sum)
